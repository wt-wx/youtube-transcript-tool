# PRD：YouTube 历史存量全自动 Blogger 转化工厂

## 1. 项目目标

实现对特定 YouTube 频道（如“Stone 记”）8000 条存量视频的自动化处理：提取音频 -> AI 转录文字 -> Gemini 双风格改写 -> 自动发布至两个独立运营的 Blogger 博客。

---

## 2. 核心业务流程

### 阶段一：数据采集与任务排队（已在 Sheets 运行）

* **功能**：通过 `nextPageToken` 机制分批抓取 8000 条视频的 URL 和 Video ID。
* **逻辑**：每 15-30 分钟运行一次，直到 `log` 表显示 `COMPLETED`。
* **输出**：在 `Production` 表中生成待处理清单，初始状态为“等待处理”。

### 阶段二：分布式 ASR 字幕工厂（VPS 核心任务）

* **任务 A (LA 节点)**：
    * 监控 `Production` 表，提取状态为“等待处理”且 E 列为空的行。
    * 调用 `yt-dlp` 限速下载音频（避免 IP 风控）并同步至 Google Drive。
    * 更新状态为“音频已就绪”。

* **任务 B (HK 节点)**：
    * 扫描状态为“音频已就绪”的任务，下载音频到本地。
    * 使用 `Faster-Whisper` (Large-v3/Medium) 生成高精度字幕。
    * **回填数据**：将完整字幕填入表格 **E 列**，并将状态更新为 **“等待处理”**（标记 ASR 已完成）。

### 阶段三：AI 改写与 Blogger 同步（Apps Script 自动化）

* **功能**：扫描表格中状态为“等待处理”且 **E 列已有内容** 的行。
* **AI 创作**：调用 Gemini 1.5 Flash API，根据 E 列字幕生成两篇文章：
    * **Blog A (深度版)**：执行 PROMPT_A，定位资深分析师风格。
    * **Blog B (复刻版)**：执行 PROMPT_B，保留博主原始口吻。
* **自动分发**：调用 Blogger API 将文章推送至指定的两个 Blog ID。
* **结果闭环**：在表格 **D 列** 填入已生成的博客链接，状态设为 **“发布成功 ✅”**。

---

## 3. 关键功能点 (Feature List)

| 模块 | 关键需求 | 备注 |
| --- | --- | --- |
| **风控管理** | LA 下载限速、随机休眠、多 VPS 分工。 | 保护 YouTube 访问不被拉黑。 |
| **存储中转** | 支持 Google Drive API 或 Rclone 同步 | 解决 8000 条音频的存储空间问题。 |
| **容错机制** | 排除“会员专享”、“已删除”、“私有”视频。 | 防止脚本因权限问题卡死。 |
| **批量发布** | 支持 `batchProcessVideos` 批量写作。 | 确保发布频率可控。 |

---

## 4. 交付物清单

1. **Google Sheets 模版**：含 `Production`、`Config`、`log` 表及触发器。
2. **LA 采集脚本**：Python 版，负责下载与 Drive 同步。
3. **HK 转录脚本**：Python 版，负责 Faster-Whisper 推理与回填。
4. **Apps Script 核心**：含 Gemini 调用与 Blogger 自动发布逻辑。

---

### 💡 需求执行状态说明：

目前项目已完成 ASR 字幕工厂（阶段二）的核心脚本开发与仓库构建。通过分阶段执行，我们将确保 8000 条存量数据在不触碰 YouTube 阈值的情况下平稳完成内容化资产转换。